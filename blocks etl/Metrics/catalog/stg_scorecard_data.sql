

{% set
    act_hf_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_d_op')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_d_ip')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_pfex')
        },     
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_ee_adc')
        },
        {
            "domain": "'operational'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_g_ip_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_g_ip_visit')
        },
        {
            "domain": "'operational'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_g_pat_days')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_g_op_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_g_op_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_act_hf_build_g_telemed')
        }
    ]
%}

{% set
    airway_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_d_op')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_d_ip')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_ee_adc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_g_ip_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_g_ip_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_g_op_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_g_op_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_g_office_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_g_procedure')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_g_pat_days')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 6,
            "table": ref('stg_frontier_airway_build_g_telemed')
        }
    ]
%}

{% set
    ccpm_metrics = [
                {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_d_clincal_trial')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_d_med_grouper')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_d_refractory')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_ee_adc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_g_all_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_g_ip_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_g_op_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_g_op_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "table": ref('stg_frontier_ccpm_build_g_pat_days')
        }
    ]
%}

{% set
    ctis_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_d_op')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_d_ip')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_ee_adc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_g_ip_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_g_ip_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_g_op_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_g_op_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_g_surgery')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_g_total_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 7,
            "table": ref('stg_frontier_ctis_build_g_pat_days')
        }
    ]
%}

{% set
    cva_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_d_ip_consult')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_d_op_multi_d')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_d_op_onco')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_ee_adc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_g_ip_consult')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_g_ip_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_g_ip_progress')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_g_op_multi_d_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_g_op_multi_d_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_g_op_onco_day_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_g_op_onco_day_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_g_pat_days')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_cva_build_pfex')
        }
    ]
%}

{% set
    drof_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_d_nss')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_d_nnss')
        },
                {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_d_cs')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_d_cno')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_ee_adc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_g_ip_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_g_ip_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_g_all_births')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_g_surgery')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_drof_build_g_pat_days')
        }
    ]
%}

{% set
    engin_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_d_op')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_d_ip')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_ee_adc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_g_ip_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_g_pat_days')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_g_op_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_g_op_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_g_noshow_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_g_new_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_g_mri')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_g_eeg')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_g_surgery')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_engin_build_g_telemed')
        }
    ]
%}

{% set
    fa_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_d_eg')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_d_eoe')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_d_fpies')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_d_ige')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_fc_speci')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_fc_total')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_ndscpy')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_patient_ec')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_patient_eg')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_patient_eoe')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_patient_fpies')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_patient_ige')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_telemed')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_visit_ec')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_visit_eg')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_visit_eoe')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_visit_fpies')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_food_allergy_build_g_visit_ige')
        }
    ]
%}

{% set
    heart_valve_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_d_all_demo')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_pfex')
        },    

        
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_ee_adc')
        },
        {
            "domain": "'operational'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_g_unique_pat')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_g_consult')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_g_echo')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_g_genrl_echo')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_g_surgery')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_g_cath')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_g_trans_cath')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_g_cta')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_g_mri')
        },
        {
            "domain": "'operational'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_heart_valve_build_g_pat_days')
        }
    ]
%}

{% set
    hi_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_d_op')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_d_ip')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_ee_adc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_g_hifp')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_g_ip_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_g_ip_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_g_op_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_g_op_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_g_pat_days')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_g_pet_scan')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_g_telemed')
        },
        {
           "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_hi_build_g_surgery')
        }
    ]
%}

{% set
    id_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_d_op')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_d_ip')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_ee_adc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_g_ip_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_g_ip_consult')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_g_ip_progress')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_g_op_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_g_op_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 5,
            "table": ref('stg_frontier_id_build_g_pat_days')
        }
    ]
%}

{% set
    lymph_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 8,
            "table": ref('stg_frontier_lymphatics_build_d_op')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 8,
            "table": ref('stg_frontier_lymphatics_build_d_ip')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 8,
            "table": ref('stg_frontier_lymphatics_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 8,
            "table": ref('stg_frontier_lymphatics_build_ee_adc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 8,
            "table": ref('stg_frontier_lymphatics_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 8,
            "table": ref('stg_frontier_lymphatics_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 8,
            "table": ref('stg_frontier_lymphatics_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 8,
            "table": ref('stg_frontier_lymphatics_build_g_ip_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 8,
            "table": ref('stg_frontier_lymphatics_build_g_op_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 8,
            "table": ref('stg_frontier_lymphatics_build_g_op_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 8,
            "table": ref('stg_frontier_lymphatics_build_g_pat_days')
        }
    ]
%}

{% set
    minds_matter_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_d_other_concuss')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_d_mm_spclty')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_d_mm_ed')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_d_mm_pcp')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_g_all_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_g_op_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_g_ps_other_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_g_ps_other_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_g_ps_occt_n_pt')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_g_ps_pupl_test')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_g_ps_step_test')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_g_visit_ed')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_g_visit_pc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_minds_matter_build_g_op_visit')
        }
    ]
%}

{% set
    motility_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_motility_build_d_op')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_motility_build_d_ip')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_motility_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_motility_build_ee_adc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_motility_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_motility_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_motility_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_motility_build_g_ip_patient')
        },
                {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_motility_build_g_op_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_motility_build_g_op_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_motility_build_g_pat_days')
        },
                {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_motility_build_g_telemed')
        }
    ]
%}

{% set
    rare_lung_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_d_op')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_d_ip')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_ee_adc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_ip_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_ip_encounter')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_pat_days')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_ip_patient_kw_only')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_ip_consult')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_ip_progress')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_op_act_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_op_pot_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_op_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_ps_bpdph_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_ps_surgical_bx')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_ps_multd_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_rare_lung_build_g_telemed')
        }
    ]
%}

{% set
    thyroid_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_d_op')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_d_ip')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "average_daily_census_denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_ee_adc')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_ee_los')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_admission')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_discharge')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_ip_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_ip_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_op_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_op_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_elect_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_pten_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_dev_ther_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_international')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_pat_days')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_surgery')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_procedure')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 4,
            "table": ref('stg_frontier_thyroid_build_g_telemed')
        }
    ]
%}

{% set
    n_o_t_bleeding_metrics = [
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_n_o_t_bleeding_build_d_gt')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_n_o_t_bleeding_build_d_rbd')
        },
        {
            "domain": "'operational'", 
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_n_o_t_bleeding_build_pfex')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_n_o_t_bleeding_build_g_op_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_n_o_t_bleeding_build_g_op_visit')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_n_o_t_bleeding_build_g_telemed')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_n_o_t_bleeding_build_g_ps_gt_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "drill_down_two": "drill_down_two",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_n_o_t_bleeding_build_g_ps_rbd_patient')
        },
        {
            "domain": "'operational'", 
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_frontier_n_o_t_bleeding_build_g_ps_international')
        }
    ]
%}

{% set
    neo_metrics = [
        {
            "domain": "'clinical'",
            "metric_name": "'Average NICU LOS'",
            "primary_key": "episode_key",
            "drill_down_one": "cohort_group",
            "drill_down_two": "admission_source",
            "metric_date": "episode_end_day",
            "num": "nicu_los_days",
            "num_calculation": "'avg'",
            "metric_type": "'avg'",
            "desired_direction": "'down'",
            "metric_id": "'neo_avg_nicu_los'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_episodes_discharged')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Median NICU LOS'",
            "primary_key": "episode_key",
            "drill_down_one": "cohort_group",
            "drill_down_two": "admission_source",
            "metric_date": "episode_end_day",
            "num": "nicu_los_days",
            "num_calculation": "'median'",
            "metric_type": "'median'",
            "desired_direction": "'down'",
            "metric_id": "'neo_med_nicu_los'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_episodes_discharged')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'25th percentile NICU LOS'",
            "primary_key": "episode_key",
            "drill_down_one": "cohort_group",
            "drill_down_two": "admission_source",
            "metric_date": "episode_end_day",
            "num": "nicu_los_days",
            "num_calculation": "'percentile_25'",
            "metric_type": "'percentile'",
            "desired_direction": "'down'",
            "metric_id": "'neo_25_nicu_los'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_episodes_discharged')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'75th percentile NICU LOS'",
            "primary_key": "episode_key",
            "drill_down_one": "cohort_group",
            "drill_down_two": "admission_source",
            "metric_date": "episode_end_day",
            "num": "nicu_los_days",
            "num_calculation": "'percentile_75'",
            "metric_type": "'percentile'",
            "desired_direction": "'down'",
            "metric_id": "'neo_75_nicu_los'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_episodes_discharged')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Average Hospital LOS'",
            "primary_key": "visit_key",
            "drill_down_one": "cohort_group",
            "drill_down_two": "admission_source",
            "metric_date": "hospital_discharge_day",
            "num": "hospital_los_days",
            "num_calculation": "'avg'",
            "metric_type": "'avg'",
            "desired_direction": "'down'",
            "metric_id": "'neo_avg_hosp_los'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_visits_discharged')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Median Hospital LOS'",
            "primary_key": "visit_key",
            "drill_down_one": "cohort_group",
            "drill_down_two": "admission_source",
            "metric_date": "hospital_discharge_day",
            "num": "hospital_los_days",
            "num_calculation": "'median'",
            "metric_type": "'median'",
            "desired_direction": "'down'",
            "metric_id": "'neo_med_hosp_los'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_visits_discharged')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'25th percentile Hospital LOS'",
            "primary_key": "visit_key",
            "drill_down_one": "cohort_group",
            "drill_down_two": "admission_source",
            "metric_date": "hospital_discharge_day",
            "num": "hospital_los_days",
            "num_calculation": "'percentile_25'",
            "metric_type": "'percentile'",
            "desired_direction": "'down'",
            "metric_id": "'neo_25_hosp_los'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_visits_discharged')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'75th percentile Hospital LOS'",
            "primary_key": "visit_key",
            "drill_down_one": "cohort_group",
            "drill_down_two": "admission_source",
            "metric_date": "hospital_discharge_day",
            "num": "hospital_los_days",
            "num_calculation": "'percentile_75'",
            "metric_type": "'percentile'",
            "desired_direction": "'down'",
            "metric_id": "'neo_75_hosp_los'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_visits_discharged')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Harm Index'",
            "primary_key": "harm_index_id",
            "drill_down_one": "harm_type",
            "metric_date": "harm_event_dt_month",
            "num": "num_of_harm_events",
            "denom": "num_of_population_days",
            "num_calculation": "'sum'",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_id": "'neo_harm'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_harm_index')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Number of Patients'",
            "primary_key": "pat_key",
            "drill_down_one": "cohort_group",
            "metric_date": "hospital_discharge_day",
            "num": "pat_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neo_num_pat'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_visits_discharged')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Number of ECMO runs'",
            "primary_key": "ecmo_run_key",
            "drill_down_one": "treatment_team_at_ecmo_start",
            "metric_date": "ecmo_end_day",
            "num": "ecmo_run_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neo_num_ecmo'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_ecmo')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Number of ECMO days'",
            "primary_key": "ecmo_run_key",
            "drill_down_one": "treatment_team_at_ecmo_start",
            "metric_date": "ecmo_end_day",
            "num": "ecmo_run_time_days",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neo_num_ecmo_days'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_ecmo')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Average length of ECMO run'",
            "primary_key": "ecmo_run_key",
            "drill_down_one": "cannulation_type",
            "metric_date": "ecmo_end_day",
            "num": "ecmo_run_time_days",
            "num_calculation": "'avg'",
            "metric_type": "'avg'",
            "desired_direction": "'down'",
            "metric_id": "'neo_avg_ecmo'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_ecmo')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Number of episodes'",
            "primary_key": "episode_key",
            "drill_down_one": "cohort_group",
            "drill_down_two": "admission_source",
            "metric_date": "episode_end_day",
            "num": "episode_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neo_episodes'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_episodes_discharged')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Number of surgical cases'",
            "primary_key": "or_key",
            "drill_down_one": "service",
            "drill_down_two": "surgery_location_group",
            "metric_date": "surgery_day",
            "num": "or_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neo_surg_case'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_surgical_cases')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "'Neonatology Unit Patient Days'",
            "primary_key": "primary_key",
            "drill_down_one": "cohort_group",
            "drill_down_two": "admission_source",
            "metric_date": "post_date",
            "num": "patient_days",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neo_unit_pat_days'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_finance_days')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "'Average Daily Census'",
            "primary_key": "primary_key",
            "drill_down_one": "cohort_group",
            "drill_down_two": "admission_source",
            "metric_date": "post_date",
            "num": "patient_days",
            "num_calculation": "'sum'",
            "denom_calculation": "'adc'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'neo_adc'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_finance_days')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "'Department Charges'",
            "primary_key": "primary_key",
            "drill_down_one": "cost_center_name",
            "drill_down_two": "cost_center_site_name",
            "metric_date": "metric_date",
            "num": "charges_actual",
            "num_calculation": "'sum'",
            "metric_type": "'dollar'",
            "desired_direction": "'up'",
            "metric_id": "'neo_dept_charges'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_finance_charges')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "'Percent 48 hr Cancellation/No Show Rate (NFP)'",
            "primary_key": "visit_key",
            "drill_down_one": "visit_location",
            "metric_date": "encounter_date",
            "num": "no_show_or_cancel_48h_ind",
            "num_calculation": "'sum'",
            "denom": "past_appointment_ind",
            "denom_calculation": "'sum'",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_id": "'neo_nfp_late_cancel'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_nfp_visits')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "'MyCHOP Activations'",
            "primary_key": "visit_key",
            "metric_date": "hospital_discharge_date",
            "num": "mychop_activated_during_admission_ind",
            "num_calculation": "'sum'",
            "denom": "visit_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'neo_mychop_activation'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_mychop')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "'Percent of NFP Patients Lost to Two Year Follow-up'",
            "primary_key": "pat_key",
            "drill_down_one": "first_nfp_visit_location",
            "metric_date": "nfp_lost_two_years_age_out_date",
            "num": "nfp_lost_two_years_num",
            "num_calculation": "'sum'",
            "denom": "nfp_lost_two_years_denom",
            "denom_calculation": "'sum'",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_id": "'neo_nfp_lost_two_years'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_nfp_lost')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "'Percent of NFP Patients Lost to Six Year Follow-up'",
            "primary_key": "pat_key",
            "drill_down_one": "first_nfp_visit_location",
            "metric_date": "nfp_lost_six_years_age_out_date",
            "num": "nfp_lost_six_years_num",
            "num_calculation": "'sum'",
            "denom": "nfp_lost_six_years_denom",
            "denom_calculation": "'sum'",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_id": "'neo_nfp_lost_six_years'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_nfp_lost')
        },
        {
            "domain": "'operational'",
            "subdomain": "'hr'",
            "metric_name": "turnover_metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "turnover_numerator",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "'neo_turnover'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_turnover')
        },
        {
            "domain": "'operational'",
            "subdomain": "'hr'",
            "metric_name": "voluntary_turnover_metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "voluntary_turnover_numerator",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "'neo_vol_turnover'",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_turnover')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_lag": "metric_lag",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_neo_internal_mobility')
        }
    ]
%}

{% set
    onco_metrics = [
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "post_date_month_year",
            "num": "admissions",
            "num_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_lag": "'month_lag'",
            "metric_id": "'onco_unit_adm'",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_admissions_metric')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "'Department Charges'",
            "primary_key": "primary_key",
            "drill_down_one": "cost_center_name_site_group",
            "metric_date": "post_date",
            "num": "charges_actual",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'onco_dept_charges'",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_charges')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Oncology CLABSI Rate'",
            "primary_key": "primary_key",
            "metric_date": "harm_event_dt_month",
            "num": "numerator",
            "num_calculation": "'sum'",
            "denom": "num_of_population_days",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "'onco_clabsi_rate'",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_clabsi')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'New Cancer Center Patients'",
            "drill_down_one": "chop_market",
            "primary_key": "pat_key",
            "metric_date": "visit_date",
            "num": "pat_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'onco_new_pat'",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_new_patients')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "cost_center_name",
            "metric_date": "post_date",
            "num": "patient_days",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'onco_unit_pat_days'",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_patient_days')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "survey_key",
            "drill_down_one": "department_name",
            "metric_date": "visit_date",
            "num": "tbs_ind",
            "num_calculation": "'sum'",
            "denom": "survey_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_pfex')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Cancer Center Patients'",
            "primary_key": "pat_key",
            "drill_down_one": "touch_category",
            "metric_date": "visit_date",
            "num": "pat_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'onco_cc_pat'",
            "lookback_period": 3,
            "table": ref('cancer_center_visit')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Mortality Count'",
            "primary_key": "pat_key",
            "drill_down_one": "touch_category",
            "metric_date": "metric_date",
            "num": "pat_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'down'",
            "metric_id": "'onco_mort_count'",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_mortality_count')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "post_date_month_year",
            "num": "outpatient_visits",
            "num_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_lag": "'month_lag'",
            "metric_id": "'onco_op_visits'",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_outpatient_visits_metric')
        },
        {
            "domain": "'operational'",
            "subdomain": "'hr'",
            "metric_name": "turnover_metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "turnover_numerator",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "turnover_metric_id",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_turnover')
        },
        {
            "domain": "'operational'",
            "subdomain": "'hr'",
            "metric_name": "voluntary_turnover_metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "voluntary_turnover_numerator",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "voluntary_turnover_metric_id",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_turnover')
        },
        {
            "domain": "'research'",
            "metric_name": "studies_metric_name",
            "primary_key": "primary_key",
            "metric_date": "open_to_accrual_date",
            "num": "primary_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "studies_metric_id",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_non_interventional_research')
        },
        {
            "domain": "'research'",
            "metric_name": "participants_metric_name",
            "primary_key": "primary_key",
            "metric_date": "open_to_accrual_date",
            "num": "on_study_count",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "participants_metric_id",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_non_interventional_research')
        },
        {
            "domain": "'research'",
            "metric_name": "trial_metric_name",
            "primary_key": "primary_key",
            "metric_date": "open_to_accrual_date",
            "num": "primary_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "trial_metric_id",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_interventional_research')
        },
        {
            "domain": "'research'",
            "metric_name": "participants_metric_name",
            "primary_key": "primary_key",
            "metric_date": "open_to_accrual_date",
            "num": "on_study_count",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "participants_metric_id",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_interventional_research')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Referral Count'",
            "drill_down_one": "drill_down",
            "primary_key": "primary_key",
            "metric_date": "referral_date",
            "num": "primary_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'onco_referral_count'",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_referrals')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Converted Referrals Rate'",
            "drill_down_one": "drill_down",
            "primary_key": "primary_key",
            "metric_date": "referral_date",
            "num": "converted_ind",
            "num_calculation": "'sum'",
            "denom": "primary_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'onco_conv_referral'",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_referral_conversion_rate')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Radiation Oncology Patients'",
            "primary_key": "primary_key",
            "metric_date": "firsttreatmentdate",
            "num": "pat_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_radiation_oncology_patients')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_lag": "metric_lag",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_cancer_center_internal_mobility')
        }
       
    ]
%}

{% set
    neuro_metrics = [
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "survey_key",
            "drill_down_one": "drill_down",
            "metric_date": "visit_date",
            "num": "tbs_ind",
            "num_calculation": "'sum'",
            "denom": "survey_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_neuro_pfex')
        },
        {
            "domain": "'clinical'",
            "metric_name": "metric_name",
            "drill_down_one": "drill_down",
            "primary_key": "primary_key",
            "metric_date": "service_date",
            "num": "pat_key",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "'neuro_cont_eeg_pat'",
            "lookback_period": 3,
            "table": ref('stg_neuro_cont_eeg_patient')
        },
        {
            "domain": "'clinical'",
            "metric_name": "metric_name",
            "drill_down_one": "drill_down",
            "primary_key": "primary_key",
            "metric_date": "service_date",
            "num": "count_eeg_days_id",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "'neuro_cont_eeg_days'",
            "lookback_period": 3,
            "table": ref('stg_neuro_cont_eeg_volume')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Average Inpatient LOS for Neurosurgical Patients'",
            "primary_key": "visit_key",
            "metric_date": "encounter_date",
            "num": "inpatient_los_days",
            "num_calculation": "'sum'",
            "denom": "visit_key",
            "denom_calculation": "'count'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_id": "'neuro_avg_ip_los'",
            "lookback_period": 3,
            "table": ref('stg_neuro_neurosurgical_los')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Average ICU LOS for Neurosurgical Patients'",
            "primary_key": "visit_key",
            "metric_date": "encounter_date",
            "num": "icu_los_days ",
            "num_calculation": "'sum'",
            "denom": "visit_key",
            "denom_calculation": "'count'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_id": "'neuro_avg_icu_los'",
            "lookback_period": 3,
            "table": ref('stg_neuro_neurosurgical_los')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Average Post OP LOS for Neurosurgical Patients'",
            "primary_key": "visit_key",
            "metric_date": "encounter_date",
            "num": "post_op_los_days  ",
            "num_calculation": "'sum'",
            "denom": "visit_key",
            "denom_calculation": "'count'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_id": "'neuro_avg_postop_los'",
            "lookback_period": 3,
            "table": ref('stg_neuro_neurosurgical_los_post_op')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Patients with convulsive disorders that receive surgical resection or laser ablation (excluding brain tumors)*'",
            "primary_key": "primary_key",
            "metric_date": "surgery_date",
            "num": "pat_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neuro_conv_dis_pat'",
            "lookback_period": 3,
            "table": ref('stg_neuro_epilepsy_surgery')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "'Neuro New Specialty Care Center Physician Visits'",
            "drill_down_one": "dx_grouping",
            "primary_key": "primary_key",
            "metric_date": "post_date",
            "num": "specialty_care_visit_actual",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neuro_new_scc_phys_visits'",
            "lookback_period": 3,
            "table": ref('stg_neuro_spec_visit')
        },
        {
            "domain": "'clinical'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "encounter_date",
            "num": "pat_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neuro_headache_migraine_pat'",
            "lookback_period": 3,
            "table": ref('stg_neuro_headache_migraine_op_neuro_patients')
        },
        {
            "domain": "'clinical'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "appointment_made_date",
            "drill_down_one": "department_center",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "'neuro_headache_migraine_lag'",
            "lookback_period": 3,
            "table": ref('stg_neuro_headache_migraine_new_patient_lag_time')
        },
        {
            "domain": "'clinical'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "encounter_date",
            "num": "pat_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neuro_epilepsy_seizure_pat'",
            "lookback_period": 3,
            "table": ref('stg_neuro_epilepsy_seizure_op_neuro_patients')
        },
        {
            "domain": "'clinical'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "appointment_made_date",
            "drill_down_one": "department_center",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "'neuro_epilepsy_seizure_lag'",
            "lookback_period": 3,
            "table": ref('stg_neuro_epilepsy_seizure_new_patient_lag_time')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Neurosurgery SSI Rate'",
            "primary_key": "primary_key",
            "metric_date": "harm_event_dt_month",
            "num": "numerator",
            "num_calculation": "'sum'",
            "denom": "num_of_population_days",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "'neuro_ssi_rate'",
            "lookback_period": 3,
            "table": ref('stg_neuro_ssi')
        },
        {
            "domain": "'operational'",
            "subdomain": "'hr'",
            "metric_name": "turnover_metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "turnover_numerator",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "turnover_metric_id",
            "lookback_period": 3,
            "table": ref('stg_neuro_turnover')
        },
        {
            "domain": "'operational'",
            "subdomain": "'hr'",
            "metric_name": "voluntary_turnover_metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "voluntary_turnover_numerator",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "voluntary_turnover_metric_id",
            "lookback_period": 3,
            "table": ref('stg_neuro_turnover')
        },
        {
            "domain": "'research'",
            "metric_name": "studies_metric_name",
            "primary_key": "primary_key",
            "metric_date": "open_to_accrual_date",
            "num": "primary_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "studies_metric_id",
            "lookback_period": 3,
            "table": ref('stg_neuro_non_interventional_research')
        },
        {
            "domain": "'research'",
            "metric_name": "participants_metric_name",
            "primary_key": "primary_key",
            "metric_date": "open_to_accrual_date",
            "num": "on_study_count",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "participants_metric_id",
            "lookback_period": 3,
            "table": ref('stg_neuro_non_interventional_research')
        },
        {
            "domain": "'research'",
            "metric_name": "trials_metric_name",
            "primary_key": "primary_key",
            "metric_date": "open_to_accrual_date",
            "num": "primary_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "trials_metric_id",
            "lookback_period": 3,
            "table": ref('stg_neuro_interventional_research')
        },
        {
            "domain": "'research'",
            "metric_name": "participants_metric_name",
            "primary_key": "primary_key",
            "metric_date": "open_to_accrual_date",
            "num": "on_study_count",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "participants_metric_id",
            "lookback_period": 3,
            "table": ref('stg_neuro_interventional_research')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Neurosurgical Case Volume'",
            "primary_key": "or_key",
            "metric_date": "surgery_date",
            "num": "or_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neuro_surg_case'",
            "lookback_period": 3,
            "table": ref('stg_neuro_surgical_cases')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Epilepsy Surgery - Unique Patient Volume'",
            "primary_key": "pat_key",
            "metric_date": "surgery_date",
            "num": "pat_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neuro_epilep_surg_pat'",
            "lookback_period": 3,
            "table": ref('stg_neuro_epilepsy_surgical_cases')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Epilepsy Surgery - Case Volume'",
            "primary_key": "or_key",
            "metric_date": "surgery_date",
            "num": "or_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'neuro_epilep_surg_cases'",
            "lookback_period": 3,
            "table": ref('stg_neuro_epilepsy_surgical_cases')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_lag": "metric_lag",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_neuro_internal_mobility')
         }
    ]
%}

{% set
    pc_metrics = [
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "question_metric_name",
            "primary_key": "survey_key",
            "drill_down_one": "drill_down",
            "metric_date": "visit_date",
            "num": "tbs_ind",
            "num_calculation": "'sum'",
            "denom": "survey_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "question_metric_id",
            "lookback_period": 3,
            "table": ref('stg_care_network_primary_pfex')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "section_metric_name",
            "primary_key": "survey_key",
            "drill_down_one": "drill_down",
            "metric_date": "visit_date",
            "num": "tbs_ind",
            "num_calculation": "'sum'",
            "denom": "survey_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "section_metric_id",
            "lookback_period": 3,
            "table": ref('stg_care_network_primary_pfex')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "survey_line_metric_name",
            "primary_key": "survey_key",
            "drill_down_one": "drill_down",
            "metric_date": "visit_date",
            "num": "tbs_ind",
            "num_calculation": "'sum'",
            "denom": "survey_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "survey_line_metric_id",
            "lookback_period": 3,
            "table": ref('stg_care_network_primary_pfex')
        },
        {
            "domain": "'operational'",
            "subdomain": "'access center'",
            "metric_name": "metric_name",
            "primary_key": "visit_key",
            "drill_down_one": "drill_down",
            "drill_down_two": "provider_name",
            "metric_date": "encounter_date",
            "num": "scheduled_to_encounter_days",
            "num_calculation": "'median'",
            "metric_type": "'median'",
            "desired_direction": "'down'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_growth_visit_lag_new')
        },
        {
            "domain": "'operational'",
            "subdomain": "'access center'",
            "metric_name": "metric_name",
            "primary_key": "visit_key",
            "drill_down_one": "drill_down",
            "drill_down_two": "provider_name",
            "metric_date": "encounter_date",
            "num": "scheduled_to_encounter_days",
            "num_calculation": "'median'",
            "metric_type": "'median'",
            "desired_direction": "'down'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_growth_visit_lag_well')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Total Newborn Patients'",
            "primary_key": "visit_key",
            "drill_down_one": "department_name",
            "metric_date": "encounter_date",
            "num": "first_newborn_encounter_ind",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'pc_growth_newborn'",
            "lookback_period": 3,
            "table": ref('encounter_primary_care')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Total Newborn Patients %'",
            "primary_key": "visit_key",
            "drill_down_one": "department_name",
            "metric_date": "encounter_date",
            "num": "first_newborn_encounter_ind",
            "num_calculation": "'sum'",
            "denom": "pat_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'pc_growth_newborn_perc'",
            "lookback_period": 3,
            "table": ref('encounter_primary_care')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "'MyCHOP Scheduled Visits'",
            "primary_key": "visit_key",
            "drill_down_one": "department_name",
            "metric_date": "encounter_date",
            "num": "mychop_scheduled_ind",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'pc_pfex_mychop_scheduled_visit'",
            "lookback_period": 3,
            "table": ref('encounter_primary_care')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "'MyCHOP Scheduled Visits %'",
            "primary_key": "visit_key",
            "drill_down_one": "department_name",
            "metric_date": "encounter_date",
            "num": "mychop_scheduled_ind",
            "num_calculation": "'sum'",
            "denom": "visit_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'pc_pfex_mychop_scheduled_visit_perc'",
            "lookback_period": 3,
            "table": ref('encounter_primary_care')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "period_start_dt",
            "num": "service_level_calls_answered_cnt",
            "num_calculation": "'sum'",
            "denom": "denominator",
            "denom_calculation": "'sum'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_care_network_primary_sl')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "period_start_dt",
            "num": "service_level_calls_answered_cnt",
            "num_calculation": "'sum'",
            "denom": "denominator",
            "denom_calculation": "'sum'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_care_network_primary_sl_ahp')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Total Unique Patients'",
            "primary_key": "visit_key",
            "metric_date": "encounter_date",
            "num": "pat_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",           
            "metric_id": "'pc_growth_unique_patients'",
            "lookback_period": 3,
            "table": ref('encounter_primary_care')
        },
        {
            "domain": "'operational'",
            "subdomain": "'access center'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "department_name",
            "drill_down_two": "provider_name",
            "metric_date": "encounter_date",
            "num": "scheduled_ind",
            "num_calculation": "'sum'",
            "denom": "available_ind",
            "denom_calculation": "'sum'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_ee_slots')
        },
        {
            "domain": "'operational'",
            "subdomain": "'access center'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "department_name",
            "metric_date": "metric_date",
            "num": "visit_key",
            "num_calculation": "'count'",
            "denom": "pat_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_ee_flu')
        },
        {
            "domain": "'clinical'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "department_name",
            "metric_date": "month_year",
            "num": "pat_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_lag": "'month_lag'",        
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_growth_active_patients')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "'Total Visit Volume'",
            "primary_key": "primary_key",
            "drill_down_one": "cost_center_name",
            "metric_date": "post_date_month",
            "num": "metric_actual_value",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'", 
            "metric_lag": "'month_lag'",        
            "metric_id": "'pc_growth_actual_visit_volume'",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_finance_visit_actual')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "'Operating Income - Primary Care ($)'",
            "primary_key": "primary_key",
            "drill_down_one": "cost_center_name",
            "metric_date": "post_date_month",
            "num": "operating_income",
            "num_calculation": "'sum'",
            "metric_type": "'dollar'",
            "desired_direction": "'up'", 
            "metric_lag": "'month_lag'",   
            "metric_id": "'pc_finance_net_operating_income'",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_finance_income')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "'Operating Income - Primary Care (%)'",
            "primary_key": "primary_key",
            "drill_down_one": "cost_center_name",
            "drill_down_two": "cost_center_site_name",
            "metric_date": "post_date_month",
            "num": "operating_income",
            "num_calculation": "'sum'",
            "denom": "operating_revenue",
            "denom_calculation": "'sum'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_lag": "'month_lag'",    
            "metric_id": "'pc_finance_operating_income_ratio'",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_finance_income')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Total New Patients (Excluding Newborns)'",
            "primary_key": "visit_key",
            "drill_down_one": "department_name",
            "metric_date": "encounter_date",
            "num": "pc_sl_new_patient_ind",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",           
            "metric_id": "'pc_growth_new_patients_ex_newborn'",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_growth_new_patients')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Total New Patients (Excluding Newborns) %'",
            "primary_key": "visit_key",
            "drill_down_one": "department_name",
            "metric_date": "encounter_date",
            "num": "pc_sl_new_patient_ind",
            "num_calculation": "'sum'",
            "denom": "pat_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",          
            "metric_id": "'pc_growth_new_patients_ex_newborn_perc'",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_growth_new_patients')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Developmental Screening Rate'",
            "primary_key": "visit_key",
            "drill_down_one": "department_name",
            "drill_down_two": "provider_name",
            "metric_date": "encounter_date",
            "num": "screening_pat_key",
            "num_calculation": "'count'",
            "denom": "pat_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'pc_ee_developmental_screening'",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_ee_developmental_screening')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Immunization Rates - Under 2 years old'",
            "primary_key": "visit_key",
            "drill_down_one": "department_name",
            "metric_date": "contact_dt",
            "num": "immunization_ind",
            "num_calculation": "'sum'",
            "denom": "visit_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'pc_ee_immunization_rate'",
            "lookback_period": 3,
            "table": ref('care_network_primary_care_immunization_under2')
        },
        {
            "domain": "'operational'",
            "metric_name": "'Visit Demand'",
            "primary_key": "primary_key",
            "drill_down_one": "department_name",
            "metric_date": "month_year",
            "num": "pat_key",
            "num_calculation": "'count_2.5x'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_lag": "'month_lag'",        
            "metric_id": "'pc_growth_visit_demand'",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_growth_active_patients')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'VBC - Well Visit Rate'",
            "primary_key": "primary_key",
            "drill_down_one": "department_name",
            "metric_date": "month_year",
            "num": "pat_required_well_completed",
            "num_calculation": "'count'",
            "denom": "pat_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'pc_ee_well_visits'",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_ee_well_visit')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'VBC - Adolescent Well Visit Rate'",
            "primary_key": "primary_key",
            "drill_down_one": "department_name",
            "metric_date": "month_year",
            "num": "pat_required_well_completed",
            "num_calculation": "'count'",
            "denom": "pat_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'pc_ee_adolescent_well_visits'",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_ee_well_visit_adolescent')
        },
        {
            "domain": "'operational'",
            "metric_name": "turnover_metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "turnover_numerator",
            "num_calculation": "'sum'",
            "denom": "denom",
            "denom_calculation": "'sum'",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "turnover_metric_id",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_people_turnover')
        },       
        {
            "domain": "'operational'",
            "metric_name": "voluntary_turnover_metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "voluntary_turnover_numerator",
            "num_calculation": "'sum'",
            "denom": "denom",
            "denom_calculation": "'sum'",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "voluntary_turnover_metric_id",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_people_turnover')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'PHQ-9 Screening Rate'",
            "primary_key": "pat_key",
            "drill_down_one": "department_name",
            "drill_down_two": "provider_name",
            "metric_date": "encounter_date",
            "num": "questionnaire_pat_key",
            "num_calculation": "'count'",
            "denom": "pat_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'pc_ee_phq9'",
            "lookback_period": 3,
            "table": ref('stg_care_network_pc_ee_phq9')
        }
     ]
%}
 
{% set
    cardiac_metrics = [
        {
            "domain": "'clinical'",
            "metric_name": "'Bounceback Count - 24 Hours'",
            "primary_key": "primary_key",
            "metric_date": "ccu_discharge_date",
            "num": "ccu_bounceback_24_ind",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'down'",
            "metric_id": "metric_id_24",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_bouncebacks')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Bounceback Count - 48 Hours'",
            "primary_key": "primary_key",
            "metric_date": "ccu_discharge_date",
            "num": "ccu_bounceback_48_ind",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'down'",
            "metric_id": "metric_id_48",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_bouncebacks')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Bounceback Count - 72 Hours'",
            "primary_key": "primary_key",
            "metric_date": "ccu_discharge_date",
            "num": "ccu_bounceback_72_ind",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'down'",
            "metric_id": "metric_id_72",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_bouncebacks')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Cardiac Arrests'",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "primary_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'down'",
            "metric_id": "metric_id_arrest_cases",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_arrests')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Cardiac Arrest Patients'",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "pat_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'down'",
            "metric_id": "metric_id_arrest_patients",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_arrests')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Cardiac Catheterization Cases'",
            "primary_key": "primary_key",
            "drill_down_one": "procedure_type_category",
            "metric_date": "cath_date",
            "num": "primary_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_cath_cases')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "'Cardiac Specialty Care Center Physician Visits'",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "post_date",
            "num": "specialty_care_visit_actual",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_spec_visits')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "'Cardiac Unit Admissions'",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "visual_month",
            "num": "admissions",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_lag": "'month_lag'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_cardiac_admissions_metric')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "'Cardiac Unit Patient Days'",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "post_date",
            "num": "patient_days",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_patient_days')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Cardiology Fill Rate'",
            "primary_key": "primary_key",
            "drill_down_one": "department_name",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "'sum'",
            "denom": "denom",
            "denom_calculation": "'sum'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_fill_rate')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Cardiothoracic SSI Rate'",
            "primary_key": "primary_key",
            "metric_date": "harm_event_dt_month",
            "num": "numerator",
            "num_calculation": "'sum'",
            "denom": "num_of_population_days",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_ssi')
        },
        {
            "domain": "'operational'",
            "subdomain": "'finance'",
            "metric_name": "'Department Charges'",
            "primary_key": "primary_key",
            "drill_down_one": "cost_center_site_name",
            "metric_date": "post_date",
            "num": "charges_actual",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_charges')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Fetal Echocardiograms'",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "study_date",
            "num": "primary_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_fetal_echo')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Harm Index'",
            "primary_key": "primary_key",
            "drill_down_one": "harm_type",
            "metric_date": "harm_event_dt_month",
            "num": "num_of_harm_events",
            "num_calculation": "'sum'",
            "denom": "num_of_population_days",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_harm_index')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'New FHP Patients Diagnosed with CHD'",
            "primary_key": "primary_key",
            "metric_date": "initial_fhp_date",
            "num": "primary_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_new_fetal_heart')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Norwood One Year Survival Rate Without Heart Transplant'",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down",
            "metric_date": "norwood_date",
            "num": "one_year_survival_ind",
            "num_calculation": "'sum'",
            "denom": "primary_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_lag": "'survival'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_norwood_survival')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'One Year Heart Transplant Survival Rate'",
            "primary_key": "primary_key",
            "metric_date": "surgery_date",
            "num": "num",
            "num_calculation": "'sum'",
            "denom": "primary_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_lag": "'survival'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_one_year_heart_transplant_survival')
        },
        {
            "domain": "'clinical'",
            "metric_name": "'Open Heart Surgery Cases'",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "primary_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_open_heart_surgeries')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "'Percent 48 hr Cancellation/No Shows'",
            "primary_key": "primary_key",
            "drill_down_one": "department_name",
            "metric_date": "encounter_date",
            "num": "num",
            "num_calculation": "'sum'",
            "denom": "denom",
            "denom_calculation": "'sum'",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_late_cancel')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pfex'",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "department_name",
            "metric_date": "visit_date",
            "num": "tbs_ind",
            "num_calculation": "'sum'",
            "denom": "survey_key",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_pfex')
        },
        {
            "domain": "'operational'",
            "subdomain": "'hr'",
            "metric_name": "turnover_metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "turnover_numerator",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "turnover_metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_turnover')
        },
        {
            "domain": "'operational'",
            "subdomain": "'hr'",
            "metric_name": "voluntary_turnover_metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "voluntary_turnover_numerator",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "voluntary_turnover_metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_turnover')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "drill_down_one": "drill_down_one",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_lag": "metric_lag",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_internal_mobility')
        },
         {
            "domain": "'research'",
            "metric_name": "studies_metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "primary_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "studies_metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_non_interventional_research')
        },
        {
            "domain": "'research'",
            "metric_name": "participants_metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "on_study_count",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "participants_metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_non_interventional_research')
        },
        {
            "domain": "'research'",
            "metric_name": "trial_metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "primary_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "trial_metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_interventional_research')
        },
        {
            "domain": "'research'",
            "metric_name": "participants_metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "on_study_count",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "participants_metric_id",
            "lookback_period": 3,
            "table": ref('stg_sl_dash_cardiac_interventional_research')
        }
     ]
%}

{% set
    specialty_metrics = [
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_fill_rate_phys_app_psych')
        },
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_fill_rate_ancillary_services')
        },
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_online_scheduling_phys_app_psych')
        },
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_online_scheduling_ancillary_services')
        },
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_no_show_late_cancel_phys_app_psych')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_no_show_late_cancel_ancillary_services')
        },
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_late_cancel_24_phys_app_psych')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_late_cancel_24_ancillary_services')
        },
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "specialty_name", 
            "drill_down_two": "department_center",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "'sum'",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_metrics_np_lag')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_call_abandonment_rate')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_call_answer_service_level')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_call_volume')
        },
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_encounter_phys_app_psych')
        },
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_encounter_ancillary_services')
        },
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_visit')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_pfex_ltr')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_pfex_communication')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_pfex_access')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_pfex_staff_worked_together')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_pfex_move_through_visit')
        },
        
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_pfex_ease_of_scheduling')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_pfex_informed_delays')
        },
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "drill_down_one": "drill_down_one", 
            "drill_down_two": "drill_down_two",
            "num": "num",
            "num_calculation": "num_calculation",
            "denom": "denom",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('stg_scorecard_spec_pfex_needs_sensitivity')
        }
        
     ]
%}

{% set
    safety_metrics = [
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "'sum'",
            "denom": "denom",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "'enterprise_clabsi'",
            "lookback_period": 3,
            "table": ref('stg_metrics_patient_safety_clabsi')
        },
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "'sum'",
            "denom": "denom",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "'enterprise_havi'",
            "lookback_period": 3,
            "table": ref('stg_metrics_patient_safety_havi')
        },
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "'sum'",
            "denom": "denom",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "'enterprise_ssi'",
            "lookback_period": 3,
            "table": ref('stg_metrics_patient_safety_ssi')
        },
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "'sum'",
            "denom": "denom",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_lag": "'month_lag'",
            "metric_id": "'enterprise_pivie'",
            "lookback_period": 3,
            "table": ref('stg_metrics_patient_safety_pivie')
        }

    ]
%}
{% set
    eop_metrics = [
        {
            "domain": "domain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "num_calculation",
            "metric_type": "metric_type",
            "desired_direction": "'up'",
            "metric_id": "'enterprise_high_impact_publication'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_eop_high_impact_publication')
        }
    ]
%}

{% set
    usnwr_metrics = [
        {
            "domain": "domain",
            "subdomain": "subdomain",
            "metric_name": "metric_name",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "denom": "denom", 
            "num_calculation": "num_calculation",
            "denom_calculation": "denom_calculation",
            "metric_type": "metric_type",
            "desired_direction": "desired_direction",
            "metric_id": "metric_id",
            "lookback_period": 3,
            "table": ref('usnews_detail')
        }
    ]
%}

{% set
    capacity_metrics = [
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Number of Admissions'",
            "primary_key": "visit_key",
            "drill_down_one": "admission_department_center_abbr",
            "drill_down_two": "admission_department_group_name",
            "metric_date": "inpatient_census_admit_date",
            "num": "visit_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_admissions'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_admissions')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'% ED MRFT to Admit in 2 hours'",
            "primary_key": "visit_key",
            "drill_down_one": "admission_department_center_abbr",
            "drill_down_two": "admission_department_group_name",
            "metric_date": "inpatient_census_admit_date",
            "num": "ed_mrft_to_admit_target_ind",
            "denom": "visit_key",
            "num_calculation": "'sum'",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_mrft_to_admit'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_ed_admissions')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'CHOP Enterprise Transport Dispatch Efficiency (% Under 60 min)'",
            "primary_key": "visit_key",
            "drill_down_one": "admission_department_center_abbr",
            "drill_down_two": "admission_department_group_name",
            "metric_date": "inpatient_census_admit_date",
            "num": "intake_to_enroute_target_ind",
            "denom": "visit_key",
            "num_calculation": "'sum'",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_intake_to_enroute'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_transport_admissions')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Clean Request to Clean Room for Admissions (% Within Target)'",
            "primary_key": "adt_bed_visit_event_key",
            "drill_down_one": "department_center_abbr",
            "drill_down_two": "department_group_name",
            "metric_date": "enter_date",
            "num": "clean_request_to_clean_target_ind",
            "denom": "adt_bed_visit_event_key",
            "num_calculation": "'sum'",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_clean_to_admit'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_bed_clean_requests_admissions')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Number of Discharges'",
            "primary_key": "visit_key",
            "drill_down_one": "discharge_department_center_abbr",
            "drill_down_two": "discharge_department_group_name",
            "metric_date": "hospital_discharge_date",
            "num": "visit_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_discharges'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_discharges')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'% Discharges by Noon'",
            "primary_key": "visit_key",
            "drill_down_one": "discharge_department_center_abbr",
            "drill_down_two": "discharge_department_group_name",
            "metric_date": "hospital_discharge_date",
            "num": "discharge_before_noon_ind",
            "denom": "visit_key",
            "num_calculation": "'sum'",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_disch_before_noon'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_discharges')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Discharge Order to Discharge (min)'",
            "primary_key": "visit_key",
            "drill_down_one": "discharge_department_center_abbr",
            "drill_down_two": "discharge_department_group_name",
            "metric_date": "hospital_discharge_date",
            "num": "discharge_order_to_discharge_mins",
            "denom": "visit_key",
            "num_calculation": "'median'",
            "metric_type": "'median'",
            "desired_direction": "'down'",
            "metric_id": "'capacity_disch_ord_to_disch'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_discharges')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Median Hospital LOS'",
            "primary_key": "visit_key",
            "drill_down_one": "discharge_department_center_abbr",
            "drill_down_two": "discharge_department_group_name",
            "metric_date": "hospital_discharge_date",
            "num": "hospital_los_days",
            "denom": "visit_key",
            "num_calculation": "'median'",
            "metric_type": "'median'",
            "desired_direction": "'down'",
            "metric_id": "'capacity_hosp_median_los'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_discharges'),
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'LOS/Expected LOS'",
            "primary_key": "visit_key",
            "drill_down_one": "admission_department_center_abbr",
            "drill_down_two": "admission_department_group_name",
            "metric_date": "hospital_discharge_date",
            "num": "hospital_los_days",
            "denom": "expected_hospital_los_days",
            "num_calculation": "'sum'",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_id": "'capacity_expected_los_ratio'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_los'),
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Contact Census'",
            "primary_key": "visit_key",
            "drill_down_one": "department_center_abbr",
            "drill_down_two": "department_group_name",
            "metric_date": "census_date",
            "num": "visit_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_contact_census'",
            "lookback_period": 3,
            "table": ref('capacity_ip_hourly_census')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Peak Occupancy Above 95% Threshold'",
            "primary_key": "dt_key",
            "metric_date": "census_date",
            "num": "threshold_red_ind",
            "denom": "dt_key",
            "num_calculation": "'sum'",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'down'",
            "metric_id": "'capacity_occ_above_95'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_peak_occupancy')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Average Peak Occupancy'",
            "primary_key": "dt_key",
            "metric_date": "census_date",
            "num": "peak_occupancy",
            "denom": "dt_key",
            "num_calculation": "'avg'",
            "denom_calculation": "null",
            "metric_type": "'avg'",
            "desired_direction": "'down'",
            "metric_id": "'capacity_avg_peak_occ'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_peak_occupancy')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Average Midnight Census'",
            "primary_key": "surrogate_key",
            "drill_down_one": "department_center_abbr",
            "drill_down_two": "department_group_name",
            "metric_date": "midnight_date",
            "num": "surrogate_key",
            "denom": "dt_key",
            "num_calculation": "'count'",
            "denom_calculation": "'count'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_avg_midnight_census'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_midnight_census')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Unit MRFT to Unit Admit (min)'",
            "primary_key": "visit_event_key",
            "drill_down_one": "department_center_abbr",
            "drill_down_two": "department_group_name",
            "metric_date": "unit_transfer_date",
            "num": "mrft_to_unit_transfer_mins",
            "denom": "visit_event_key",
            "num_calculation": "'median'",
            "metric_type": "'median'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_unit_mfrt_to_unit_admit'",
            "lookback_period": 3,
            "table": ref('capacity_ip_transfer_intervals')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Clean Request to Clean Room (% Within Target)'",
            "primary_key": "visit_event_key",
            "drill_down_one": "department_center_abbr",
            "drill_down_two": "department_group_name",
            "metric_date": "clean_request_date",
            "num": "clean_request_to_clean_target_ind",
            "denom": "visit_event_key",
            "num_calculation": "'sum'",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_clean_req_to_clean'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_bed_clean_requests')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Number of Admissions'",
            "primary_key": "visit_key",
            "drill_down_one": "admission_service",
            "drill_down_two": "admission_department_center_abbr",
            "metric_date": "inpatient_census_admit_date",
            "num": "visit_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_admissions'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_admissions')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'% ED MRFT to Admit in 2 hours'",
            "primary_key": "visit_key",
            "drill_down_one": "admission_service",
            "drill_down_two": "admission_department_center_abbr",
            "metric_date": "inpatient_census_admit_date",
            "num": "ed_mrft_to_admit_target_ind",
            "denom": "visit_key",
            "num_calculation": "'sum'",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_mrft_to_admit'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_ed_admissions')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'CHOP Enterprise Transport Dispatch Efficiency (% Under 60 min)'",
            "primary_key": "visit_key",
            "drill_down_one": "admission_service",
            "drill_down_two": "admission_department_center_abbr",
            "metric_date": "inpatient_census_admit_date",
            "num": "intake_to_enroute_target_ind",
            "denom": "visit_key",
            "num_calculation": "'sum'",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_intake_to_enroute'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_transport_admissions')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Clean Request to Clean Room for Admissions (% Within Target)'",
            "primary_key": "adt_bed_visit_event_key",
            "drill_down_one": "admission_service",
            "drill_down_two": "department_center_abbr",
            "metric_date": "enter_date",
            "num": "clean_request_to_clean_target_ind",
            "denom": "adt_bed_visit_event_key",
            "num_calculation": "'sum'",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_clean_to_admit'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_bed_clean_requests_admissions')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Number of Discharges'",
            "primary_key": "visit_key",
            "drill_down_one": "discharge_service",
            "drill_down_two": "discharge_department_center_abbr",
            "metric_date": "hospital_discharge_date",
            "num": "visit_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_discharges'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_discharges')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'% Discharges by Noon'",
            "primary_key": "visit_key",
            "drill_down_one": "discharge_service",
            "drill_down_two": "discharge_department_center_abbr",
            "metric_date": "hospital_discharge_date",
            "num": "discharge_before_noon_ind",
            "denom": "visit_key",
            "num_calculation": "'sum'",
            "denom_calculation": "'count'",
            "metric_type": "'percentage'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_disch_before_noon'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_discharges')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Discharge Order to Discharge (min)'",
            "primary_key": "visit_key",
            "drill_down_one": "discharge_service",
            "drill_down_two": "discharge_department_center_abbr",
            "metric_date": "hospital_discharge_date",
            "num": "discharge_order_to_discharge_mins",
            "denom": "visit_key",
            "num_calculation": "'median'",
            "metric_type": "'median'",
            "desired_direction": "'down'",
            "metric_id": "'capacity_disch_ord_to_disch'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_discharges')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Median Hospital LOS'",
            "primary_key": "visit_key",
            "drill_down_one": "discharge_service",
            "drill_down_two": "discharge_department_center_abbr",
            "metric_date": "hospital_discharge_date",
            "num": "hospital_los_days",
            "denom": "visit_key",
            "num_calculation": "'median'",
            "metric_type": "'median'",
            "desired_direction": "'down'",
            "metric_id": "'capacity_hosp_median_los'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_discharges'),
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'LOS/Expected LOS'",
            "primary_key": "visit_key",
            "drill_down_one": "discharge_service",
            "drill_down_two": "admission_department_center_abbr",
            "metric_date": "hospital_discharge_date",
            "num": "hospital_los_days",
            "denom": "expected_hospital_los_days",
            "num_calculation": "'sum'",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'down'",
            "metric_id": "'capacity_expected_los_ratio'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_los'),
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Contact Census'",
            "primary_key": "visit_key",
            "drill_down_one": "service",
            "drill_down_two": "department_center_abbr",
            "metric_date": "census_date",
            "num": "visit_key",
            "num_calculation": "'count'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_contact_census'",
            "lookback_period": 3,
            "table": ref('capacity_ip_hourly_census')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Average Midnight Census'",
            "primary_key": "surrogate_key",
            "drill_down_one": "service",
            "drill_down_two": "department_center_abbr",
            "metric_date": "midnight_date",
            "num": " surrogate_key",
            "denom": "dt_key",
            "num_calculation": "'count'",
            "denom_calculation": "'count'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_avg_midnight_census'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_midnight_census')
        },
        {
            "domain": "'operational'",
            "subdomain": "'capacity'",
            "metric_name": "'Unit MRFT to Unit Admit (min)'",
            "primary_key": "visit_event_key",
            "drill_down_one": "service_at_transfer",
            "drill_down_two": "department_center_abbr",
            "metric_date": "unit_transfer_date",
            "num": "mrft_to_unit_transfer_mins",
            "denom": "visit_event_key",
            "num_calculation": "'median'",
            "metric_type": "'median'",
            "desired_direction": "'up'",
            "metric_id": "'capacity_unit_mfrt_to_unit_admit'",
            "lookback_period": 3,
            "table": ref('stg_kpi_dash_capacity_transfers')
        }
    ]
%}

{% set
    peds_kpi_metrics = [
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'Harm Index'",
            "primary_key": "primary_key",
            "drill_down_one": "harm_type",
            "metric_date": "harm_event_dt_month",
            "num": "num_of_harm_events",
            "num_calculation": "'sum'",
            "denom": "num_of_population_days",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_harm_index'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_harm_index')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'Discharge Summaries'",
            "primary_key": "primary_key",
            "metric_date": "disch_dt",
            "num": "numerator",
            "num_calculation": "'sum'",
            "denom": "denominator",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_disch_summaries'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_discharge_summaries')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'Avg Discharge Summaries Days'",
            "primary_key": "primary_key",
            "metric_date": "disch_dt",
            "num": "total_turnaround_days",
            "num_calculation": "'avg'",
            "metric_type": "'avg'",
            "desired_direction": "'down'",
            "metric_id": "'kpi_peds_avg_disch_summaries_days'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_discharge_summaries')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'New Patients Scheduled within 12 Days'",
            "primary_key": "primary_key",
            "metric_date": "appointment_made_date",
            "num": "num_new_pts_schd_within_12_days",
            "num_calculation": "'sum'",
            "denom": "denom_new_pts_schd_within_12_days",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_pct_new_pts_schd_within_12_days'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_appt_lag')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'Median New Patient Lag'",
            "primary_key": "primary_key",
            "drill_down_one": "specialty_name",
            "metric_date": "appointment_made_date",
            "num": "ped_divs_npv_appointment_lag_days",
            "num_calculation": "'median'",
            "metric_type": "'median'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_divs_median_npv_12_days'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_appt_lag')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'% No Show'",
            "primary_key": "primary_key",
            "metric_date": "encounter_date",
            "num": "no_show_appts",
            "num_calculation": "'sum'",
            "denom": "past_appointment_ind",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_pct_no_show'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_appt_inds')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'Evening Appointments'",
            "primary_key": "primary_key",
            "metric_date": "encounter_date",
            "num": "evening_ind",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_evening_appts'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_appt_inds')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'Early Appointments'",
            "primary_key": "primary_key",
            "metric_date": "encounter_date",
            "num": "early_ind",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_early_appts'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_appt_inds')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'Weekend Appointments'",
            "primary_key": "primary_key",
            "metric_date": "encounter_date",
            "num": "weekend_ind",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_weekend_appts'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_appt_inds')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'MyCHOP Activation Rate'",
            "primary_key": "primary_key",
            "metric_date": "encounter_date",
            "num": "mychop_activation_pat_key",
            "num_calculation": "'count'",
            "denom": "pat_key",
            "denom_calculation": "'count'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_mychop_patient_activation'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_mychop_activation')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'MyCHOP Visits'",
            "primary_key": "primary_key",
            "metric_date": "encounter_date",
            "num": "mychop_visit_activation_ind",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_mychop_visits'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_mychop_activation')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'EPIC Online Appointments'",
            "primary_key": "primary_key",
            "metric_date": "appt_made_date",
            "num": "mychop_appts",
            "num_calculation": "'sum'",
            "denom": "denominator",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_epic_online_appts'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_epic_online_appts')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'EPIC Online Appointments Enterprise Wide'",
            "primary_key": "primary_key",
            "metric_date": "appt_made_date",
            "num": "mychop_appts_enterprise_wide",
            "num_calculation": "'sum'",
            "denom": "denom_enterprise_wide",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_epic_online_appts_enterprise_wide'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_epic_online_appts')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'Fill Rate'",
            "primary_key": "primary_key",
            "metric_date": "metric_date",
            "num": "num",
            "num_calculation": "'sum'",
            "denom": "denom",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_fill_rate'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_fill_rate')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'Press Ganey'",
            "primary_key": "primary_key",
            "drill_down_one": "press_ganey_metric_name",
            "metric_date": "visit_date",
            "num": "numerator",
            "num_calculation": "'sum'",
            "denom": "denominator",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_pfex_top_box'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_pfex')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'CHOPPA OP Visit Volume'",
            "primary_key": "primary_key",
            "drill_down_one": "op_ip_flag",
            "drill_down_two": "telvsip",
            "metric_date": "post_date",
            "num": "total_visits",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_choppa_op_visit_volume'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_choppa_visit_volume')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'CHOPPA IP Admissions'",
            "primary_key": "primary_key",
            "metric_date": "post_date",
            "num": "ip_admissions",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_choppa_ip_admissions'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_choppa_visit_volume')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'CHOPPA SCC Growth'",
            "primary_key": "primary_key",
            "metric_date": "post_date",
            "num": "scc_growth",
            "num_calculation": "'sum'",
            "metric_type": "'count'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_choppa_scc_growth'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_choppa_visit_volume')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'Refilled Appointments'",
            "primary_key": "primary_key",
            "metric_date": "eff_dt",
            "num": "refilled_slots",
            "num_calculation": "'sum'",
            "denom": "cancelled_slots",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_refilled_appointments'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_slot_cancel_refills')
        },
        {
            "domain": "'operational'",
            "subdomain": "'pediatrics'",
            "metric_name": "'Left Without Being Seen'",
            "primary_key": "primary_key",
            "drill_down_one": "initial_ed_department_center_abbr",
            "metric_date": "metric_date",
            "num": "pats_lwbs",
            "num_calculation": "'sum'",
            "denom": "denom",
            "denom_calculation": "'sum'",
            "metric_type": "'rate'",
            "desired_direction": "'up'",
            "metric_id": "'kpi_peds_lwbs'",
            "lookback_period": 3,
            "table": ref('stg_scorecard_peds_ed_lwbs')
        }
    ]
%}

{% set metrics_filter = var('scorecard_metrics_filter') %}

{% set metrics =
    act_hf_metrics +
    airway_metrics +
    ccpm_metrics +
    ctis_metrics +
    cva_metrics +
    drof_metrics +
    engin_metrics +
    lymph_metrics +
    minds_matter_metrics +
    motility_metrics +
    n_o_t_bleeding_metrics +
    id_metrics +
    heart_valve_metrics +
    hi_metrics +
    fa_metrics +
    thyroid_metrics +
    rare_lung_metrics +
    neo_metrics +
    onco_metrics +
    neuro_metrics +
    pc_metrics +
    cardiac_metrics +
    specialty_metrics +
    safety_metrics +
    usnwr_metrics +
    eop_metrics +
    capacity_metrics +
    peds_kpi_metrics
%}

{% if metrics_filter == 'act_hf' %}
    {% set metrics = act_hf_metrics %}
{% elif metrics_filter == 'airway' %}
    {% set metrics = airway_metrics %}
{% elif metrics_filter == 'ccpm' %}
    {% set metrics = ccpm_metrics %}
{% elif metrics_filter == 'ctis' %}
    {% set metrics = ctis_metrics %}
{% elif metrics_filter == 'cva' %}
    {% set metrics = cva_metrics %}
{% elif metrics_filter == 'drof' %}
    {% set metrics = drof_metrics %}
{% elif metrics_filter == 'engin' %}
    {% set metrics = engin_metrics %}
{% elif metrics_filter == 'lymph' %}
    {% set metrics = lymph_metrics %}
{% elif metrics_filter == 'minds_matter' %}
    {% set metrics = minds_matter_metrics %}
{% elif metrics_filter == 'motility' %}
    {% set metrics = motility_metrics %}
{% elif metrics_filter == 'id' %}
    {% set metrics = id_metrics %}
{% elif metrics_filter == 'heart_valve' %}
    {% set metrics = heart_valve_metrics %}
{% elif metrics_filter == 'hi' %}
    {% set metrics = hi_metrics %}
{% elif metrics_filter == 'fa' %}
    {% set metrics = fa_metrics %}
{% elif metrics_filter == 'rare_lung' %}
    {% set metrics = rare_lung_metrics %}
{% elif metrics_filter == 'thyroid' %}
    {% set metrics = thyroid_metrics %}
{% elif metrics_filter == 'n_o_t_bleeding' %}
    {% set metrics = n_o_t_bleeding_metrics %}
{% elif metrics_filter == 'neo' %}
    {% set metrics = neo_metrics %}
{% elif metrics_filter == 'onco' %}
    {% set metrics = onco_metrics %}
{% elif metrics_filter == 'neuro' %}
    {% set metrics = neuro_metrics %}
{% elif metrics_filter == 'pc' %}
    {% set metrics = pc_metrics %}
{% elif metrics_filter == 'cardiac' %}
    {% set metrics = cardiac_metrics %}
{% elif metrics_filter == 'specialty' %}
    {% set metrics = specialty_metrics %}
{% elif metrics_filter == 'safety' %}
    {% set metrics = safety_metrics %}
{% elif metrics_filter == 'eop' %}
    {% set metrics = eop_metrics %}
{% elif metrics_filter == 'usnwr' %}
    {% set metrics = usnwr_metrics %}
{% elif metrics_filter == 'capacity' %}
    {% set metrics = capacity_metrics %}
{% elif metrics_filter == 'pediatrics' %}
    {% set metrics = peds_kpi_metrics %}
{% endif %}

with metric_data as (
    {%- for metric in metrics %}
    select
        {{ metric.domain }} as domain,
        {{ metric.subdomain|default('null') }} as subdomain,
        {{ metric.metric_name }} as metric_name,
        cast({{ metric.primary_key}} as bigint) as primary_key,
        {{ metric.drill_down_one|default("'No drilldown available'") }} as drill_down_one,
        {{ metric.drill_down_two|default("'No drilldown available'") }} as drill_down_two,
        cast({{ metric.metric_date }} as date) as metric_date,
        cast({{ metric.num }} as numeric(26, 6)) as num,
        cast({{ metric.denom|default('null') }} as numeric(26, 6)) as denom,
        {{ metric.num_calculation }} as num_calculation,
        {{ metric.denom_calculation|default('null') }} as denom_calculation,
        {{ metric.metric_type }} as metric_type,
        {{ metric.desired_direction }} as desired_direction,
        {{ metric.metric_lag|default('null') }} as metric_lag,
        {{ metric.metric_id }} as metric_id
    from
        {{ metric.table }}
    --where
    --    year(cast({{ metric.metric_date }} as date)) >= year(current_date) - {{ metric.lookback_period }}
    where
        cast({{ metric.metric_date }} as date) >= cast('{{ get_fiscal_year_begin_date() }}' as date) + interval '-{{metric.lookback_period|default(3)}} years'

    {% if not loop.last -%}
    union all
    {% endif %}

    {% endfor %}
)

select
    metric_data.*,
    calendar.*
from
    metric_data
    inner join {{ ref_for_env('stg_scorecard_calendar') }} as calendar
        on metric_data.metric_date = calendar.full_dt
/* Remove PFEX Metrics not yet ready for use */
where
    lower(metric_name) != 'metric is not ready for use'
