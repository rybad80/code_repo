select
    medication_order_administration.visit_key,
    med_ord_key,
    administration_seq_number,
    cardiac_perfusion_surgery.patient_name,
    cardiac_perfusion_surgery.mrn,
    cardiac_perfusion_surgery.dob,
    cardiac_perfusion_surgery.csn,
    encounter_date,
    hospital_admit_date,
    hospital_discharge_date,
    medication_name,
    medication_id,
    medication_form,
    medication_strength,
    generic_medication_name,
    therapeutic_class,
    therapeutic_class_id,
    pharmacy_class,
    pharmacy_class_id,
    pharmacy_sub_class,
    pharmacy_sub_class_id,
    specialty_medication_ind,
    medication_order_create_date,
    medication_order_name,
    medication_start_date,
    medication_end_date,
    order_status,
    order_dose,
    order_dose_unit,
    order_route,
    medication_route,
    order_frequency,
    medication_frequency,
    order_mode,
    order_class,
    discharge_med_ind,
    orderset_name,
    ordering_provider_name,
    authorizing_provider_name,
    ordering_department,
    administration_date,
    admin_dose,
    admin_dose_unit,
    admin_infusion_rate,
    admin_route,
    administration_type,
    administration_type_id,
    administration_department,
    med_key,
    medication_order_id,
    medication_order_dept_key,
    med_ord_dt_key,
    authorizing_prov_key,
    ordering_prov_key,
    medication_administration_dept_key,
    cardiac_perfusion_surgery.pat_key,
    hsp_acct_key
from
     {{ref('cardiac_perfusion_surgery')}} as cardiac_perfusion_surgery
     inner join {{ref('medication_order_administration')}} as medication_order_administration
       on cardiac_perfusion_surgery.anes_visit_key = medication_order_administration.visit_key
