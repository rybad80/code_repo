version: 2

models:
  - name: cardiac_clinic_encounters
    tests:
      - dbt_chop_utils.is_primary_key:
          column_names: [visit_key]   
    columns:
      - name: patient_name
        tests:
          - not_null    
      - name: dob
        tests:
          - dbt_chop_utils.date_in_past
          - not_null:
              tags: ['failing']
      - name: mrn
        tests:
          - not_null             
      - name: encounter_date
        tests:
          - not_null    
          - dbt_chop_utils.date_in_past:
              tags: ['failing']
