SELECT 
tdl.DETAIL_TYPE,
dep.GL_PREFIX as COST_CNTR_ID,
tdl.MATCH_LOC_ID,
TDL.LOC_ID,
tdl.POST_DATE,
last_day(tdl.POST_DATE) as POST_MONTH,
tdl.ORIG_POST_DATE,
tdl.ORIG_SERVICE_DATE,
tdl.PERIOD,
tdl.TX_ID,
tdl.TX_NUM,
tdl.visit_number,
tdl.TRAN_TYPE,
tdl.MATCH_TRX_ID,
tdl.MATCH_TX_TYPE,
tdl.PROC_ID,
tdl.MATCH_PROC_ID,
tdl.ACCOUNT_ID,
tdl.PAT_ID,
tdl.AMOUNT,
tdl.ACTIVE_AR_AMOUNT
FROM CDW_ODS.ADMIN.CLARITY_TDL_TRAN tdl
LEFT JOIN CDW_ODS.ADMIN.CLARITY_DEP DEP ON DEP.DEPARTMENT_ID = tdl.DEPT_ID
LEFT JOIN CDW_ODS.ADMIN.CLARITY_LOC cloc ON TDL.loc_id=cloc.loc_id
WHERE (tdl.proc_id IN (88743,78305,126888,78306,17500,17552,112241,17512,17554,17536,80849,80851,107249,111179,111237,17488,17492,17494,17496,17518,17522) 
  OR tdl.MATCH_PROC_ID IN (88743,78305,126888,78306,17500,17552,112241,17512,17554,17536,80849,80851,107249,111179,111237,17488,17492,17494,17496,17518,17522))
AND tdl.post_date between add_months(date_trunc('month',current_date),-15) and add_months(last_day(current_date),-1)
AND tdl.LOC_ID IN (1016,1017,1018,1020,1026,1029,1030,1033,1038)
;